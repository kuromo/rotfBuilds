/*! rotfBuilds - v0.0.0 - 2019-01-15
* Copyright (c) 2019 ;*/

var gSrv="http://localhost:3000/";function ceckStart(){if($(".start").hasClass("activeNode"))return!0;console.log("select start")}function secStart(t){$(".activeNode.start").toggleClass("activeNode"),$(t).toggleClass("activeNode"),calcTreeStat()}function checkCon(t){var e=parseInt(t.split("c")[0].replace(/r/g,"")),s=parseInt(t.split("c")[1]);return 1!=e&&checkAloc(e-1,s)?(console.log("t"),!0):13!=s&&checkAloc(e,s+1)?(console.log("r"),!0):15!=e&&checkAloc(e+1,s)?(console.log("b"),!0):!(1==s||!checkAloc(e,s-1))&&(console.log("l"),!0)}function checkAloc(t,e){return $(".tile[data-id='r"+t+"c"+e+"']").hasClass("activeNode")}function updateStats(t){var e="";for(var s in t){var r=t[s];Number.isInteger(r)&&0!==r&&(e+=s,e+=":  ",e+=r,e+="<br>")}$("#tStatCont").html(e);var o=$(".activeNode");$(".ptCount").text(o.length)}function calcTreeStat(){var r=new TStats;$(".activeNode").each(function(){var t=$(this).data("id"),e=t.split("c")[0],s="c"+t.split("c")[1];"start"==tree[e][s].type?calcStart(tree[e][s].val,r):r[tree[e][s].type]+=tree[e][s].val}),updateStats(r)}function calcStart(t,e){for(var s in stNodes[t])e[s]+=stNodes[t][s]}function TStats(){this.vit=0,this.vitPre=0,this.dex=0,this.dexPre=0,this.lootPre=0,this.mp=0,this.mpPre=0,this.eva=0,this.evaPre=0,this.spd=0,this.spdPre=0,this.hp=0,this.hpPre=0,this.wis=0,this.wisPre=0,this.rof=0,this.atk=0,this.atkPre=0,this.def=0,this.defPre=0}function login(){var t=$("#usrName").val(),e=$("#usrPwd").val();console.log(t+"   "+e),srvPost("login",console.log,{usrName:t,pwd:e})}function logout(){srvGet("logout",console.log)}function register(){var t={usrName:$("#usrName").val(),mail:$("#mail").val(),firstName:$("#firstName").val(),lastName:$("#lastName").val(),pwd:$("#usrPwd").val()};console.log(t),srvPost("register",console.log,t)}function forgot(){var t=$("#mail").val();srvPost("forgot",console.log,{mail:t})}function reset(){var t=$("#usrPwd").val();srvPost(window.location.pathname.substring(1),console.log,{pwd:t})}function srvGet(t,e,s){$.ajax({type:"GET",data:{},url:gSrv+t,beforeSend:function(){},success:function(t){return console.log(t.redirect),t.redirect&&(document.location.href=t.redirect),s?e(t,s):e(t),t},error:function(t){console.log(t),outputError(t)}})}function srvPost(t,e,s){$.ajax({type:"POST",url:gSrv+t,data:s,beforeSend:function(){},success:function(t){return console.log(t.redirect),t.redirect&&(document.location.href=t.redirect),e(t),t},error:function(t){console.log(t),outputError(t)}})}function outputError(t){}$(function(){skrollr.init()}),$(function(){$(".tile").click(function(){console.log(this);var t=$(".activeNode");if(!$(this).hasClass("start")&&!ceckStart())return!1;if($(this).hasClass("start")&&!$(".activeNode").hasClass("start"));else if($(this).hasClass("activeNode")){if($(this).hasClass("start")&&1!=t.length)return console.log("cant remove start"),!1}else{if(!checkCon($(this).data("id")))return console.log("not connected to start"),!1;if(!(t.length<82))return console.log("no poits left"),!1;if($(this).hasClass("start"))return secStart(this),!1}$(this).toggleClass("activeNode"),calcTreeStat()})}),TStats.prototype.getFlat=function(){return{vit:this.vit,dex:this.dex,mp:this.mp,eva:this.eva,spd:this.spd,hp:this.hp,wis:this.wis,rof:this.rof,atk:this.atk,def:this.def}},TStats.prototype.getPre=function(){return{vitPre:this.vitPre,dexPre:this.dexPre,lootPre:this.lootPre,mpPre:this.mpPre,evaPre:this.evaPre,spdPre:this.spdPre,hpPre:this.hpPre,wisPre:this.wisPre,atkPre:this.atkPre,defPre:this.defPre}},$(function(){$("#navLogBtn").click(function(){if($("#navUsr").attr("hidden"))$("#navUsr").attr("hidden",!1),$("#navPwd").attr("hidden",!1);else{var t=$("#navUsr").val(),e=$("#navPwd").val();srvPost("login",console.log,{usrName:t,pwd:e})}})});